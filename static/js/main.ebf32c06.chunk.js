(this["webpackJsonpinstagram-clone"]=this["webpackJsonpinstagram-clone"]||[]).push([[0],{25:function(e,t,n){e.exports=n(39)},30:function(e,t,n){},31:function(e,t,n){},32:function(e,t,n){},33:function(e,t,n){},34:function(e,t,n){},39:function(e,t,n){"use strict";n.r(t);var a=n(3),o=n.n(a),r=n(17),i=n.n(r),s=(n(30),n(6)),c=n(7),l=n(9),u=n(8),p=(n(31),n(32),function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){return o.a.createElement("nav",{className:"Nav"},o.a.createElement("div",{className:"Nav-menus"},o.a.createElement("div",{className:"Nav-brand"},o.a.createElement("a",{className:"Nav-brand-logo",href:"/"},"Instagram"))))}}]),n}(o.a.Component)),m=n(18),f=(n(33),n(11)),h=n.n(f),v=(n(34),function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){var e=this.props.nickname,t=this.props.avatar,n=this.props.image,a=this.props.caption;return o.a.createElement("article",{className:"Post",ref:"Post"},o.a.createElement("header",null,o.a.createElement("div",{className:"Post-user"},o.a.createElement("div",{className:"Post-user-avatar"},o.a.createElement("img",{src:t,alt:e})),o.a.createElement("div",{className:"Post-user-nickname"},o.a.createElement("span",null,e)))),o.a.createElement("div",{className:"Post-image"},o.a.createElement("div",{className:"Post-image-bg"},o.a.createElement("img",{alt:a,src:n}))),o.a.createElement("div",{className:"Post-caption"},o.a.createElement("strong",null,e)," ",a))}}]),n}(a.Component));function d(){var e=Object(m.a)(['\n            {\n              posts(user_id: "a") {\n                id\n                user {\n                  nickname\n                  avatar\n                }\n                image\n                caption\n              }\n            }\n          ']);return d=function(){return e},e}var g=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.call(this)).state={posts:[]},e.offline=!navigator.onLine,e}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=this;"actions"in Notification.prototype?alert("You can enjoy the notification feature"):alert("Sorry notifications are NOT supported on your browser"),Notification.requestPermission(),this.offline?this.setState({posts:JSON.parse(localStorage.getItem("posts"))}):this.props.apollo_client.query({query:h()(d())}).then((function(t){e.setState({posts:t.data.posts}),localStorage.setItem("posts",JSON.stringify(t.data.posts))})),this.posts_channel=this.props.pusher.subscribe("posts-channel"),this.posts_channel.bind("new-post",(function(t){if(e.setState({posts:e.state.posts.concat(t.post)}),"granted"===Notification.permission)try{new Notification("\uc778\uc2a4\ud0c0 \ud074\ub860",{body:"".concat(t.post.user.nickname,"\ub85c\uc758 \uc0c8 \uac8c\uc2dc\ubb3c\uc785\ub2c8\ub2e4."),icon:"https://img.stackshare.io/service/115/Pusher_logo.png",image:"".concat(t.post.image)}).onclick=function(e){window.open("http://localhost:3000","_blank")}}catch(n){console.log("Error displaying notification",n)}}),this)}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("div",{className:"Posts"},this.state.posts.slice(0).reverse().map((function(e){return o.a.createElement(v,{nickname:e.user.nickname,avatar:e.user.avatar,image:e.image,caption:e.caption,key:e.id})}))))}}]),n}(a.Component),b=n(24),w=n(41),E=n(19),k=n.n(E),y=new b.a({uri:"http://localhost:4000/graphql"}),N=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.call(this)).pusher=new k.a("PUSHER_APP_KEY",{cluster:"eu",encrypted:!0}),e}return Object(c.a)(n,[{key:"render",value:function(){return o.a.createElement(w.a,{client:y},o.a.createElement("div",{className:"App"},o.a.createElement(p,null),o.a.createElement("section",{className:"App-main"},o.a.createElement(g,{pusher:this.pusher,apollo_client:y}))))}}]),n}(a.Component),O=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function j(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}!function(e){if("serviceWorker"in navigator){if(new URL("/instareact",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/instareact","/service-worker.js");O?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):j(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):j(t,e)}))}}(),i.a.render(o.a.createElement(N,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[25,1,2]]]);
//# sourceMappingURL=main.ebf32c06.chunk.js.map